create database macproven;

use macproven;

CREATE TABLE ARTISTS(
    id_artist int auto_increment,
    name varchar(50) not null,
    isActive BOOLEAN DEFAULT 1,
    primary key (id_artist)
);

CREATE TABLE CATEGORIES(
    id_category int auto_increment,
    category varchar(50) not null,
    isActive BOOLEAN DEFAULT 1,
    primary key (id_category)
);


CREATE TABLE EVENTS(
    ID_EVENT INT AUTO_INCREMENT,
    FK_CATEGORY INT,
    imagePath varchar(100),
    TITLE VARCHAR (50),
    isActive BOOLEAN DEFAULT 1,
    PRIMARY KEY (ID_EVENT),
    FOREIGN KEY (FK_CATEGORY) REFERENCES CATEGORIES (ID_CATEGORY)
);


create table eventPlaces(
  quantity INT NOT NULL,
  isActive BOOLEAN DEFAULT 1,
  id_eventPlace INT NOT NULL AUTO_INCREMENT,
  name varchar(50) not null,
  PRIMARY KEY (id_eventPlace)
  );

  create table placetype(
      description varchar (50) NOT NULL,
      isActive BOOLEAN DEFAULT 1,
      id_placetype int auto_increment,
      primary key (id_placetype)
  );

 CREATE TABLE calendars(
     id_calendar int auto_increment,
     dateevent date,
     fk_id_event int not null,
     isActive BOOLEAN DEFAULT 1,
     imagePath varchar(100),
     fk_id_eventplace int not null,
     primary key (id_calendar),
     foreign key (fk_id_event) references events (id_event),
     foreign key (fk_id_eventplace) references eventplaces (id_eventplace)
 );

 CREATE TABLE eventseats(
     id_eventseat int auto_increment,
     price int not null,
     quantity int not null,
     fk_id_calendar int not null,
     isActive BOOLEAN DEFAULT 1,
     fk_id_placetype int not null,
     primary key (id_eventseat),
     foreign key (fk_id_calendar) references calendars (id_calendar),
     foreign key (fk_id_placetype) references placetype (id_placetype)
 );


create table artistsXCalendars(
    pfk_id_calendar int not null,
    pfk_id_artist int not null,
    primary key (pfk_id_artist, pfk_id_calendar),
    foreign key (pfk_id_calendar) references calendars (id_calendar),
    foreign key (pfk_id_artist) references artists (id_artist)    
);

CREATE TABLE USERS
( id_user int auto_increment,
  email varchar(50) not null,
  password varchar(50) not null,
  nickName varchar(50) not null,
  isActive BOOLEAN DEFAULT 1,
  isAdmin BOOLEAN,
  PRIMARY KEY (id_user)
);

CREATE TABLE PURCHASES
( id_purchase int auto_increment,
fk_id_user int not null,
datePurchase datetime,
PRIMARY KEY(id_purchase),
FOREIGN KEY(fk_id_user) REFERENCES USERS(id_user)
);


CREATE TABLE purchaseLines (
id_purchaseLine int AUTO_INCREMENT,
fk_id_purchase int not null,
fk_id_eventseat int not null,
quantity int not null,
price int not null,
PRIMARY KEY(id_purchaseLine),
FOREIGN KEY(fk_id_purchase) REFERENCES PURCHASES(id_purchase),
FOREIGN KEY(fk_id_eventseat) REFERENCES eventseats(id_eventseat)
);

CREATE TABLE TICKETS (
id_ticket int AUTO_INCREMENT,
qr varchar(23),
fk_id_purchaseLine int not null,
PRIMARY KEY(id_ticket),
FOREIGN KEY(fk_id_purchaseLine) REFERENCES purchaseLines(id_purchaseLine)
);

-- INSERTS

INSERT INTO ARTISTS (name) VALUES 
("Charly Garcia"),
("Shakira"),
("Luis Fonsi"),
("Damas Gratis"),
("Evanescense"),
("Axel"),
("Jeniffer Lopez"),
("Linkin Park"),
("Callejeros"),
("La Vela Puerca");

INSERT INTO CATEGORIES (CATEGORY) VALUES
("Recital"),
("Boxeo"),
("Festival de musica"),
("Comedia Musical"),
("Teatro");

INSERT INTO EVENTS (FK_CATEGORY,TITLE,imagePath) VALUES
(1,"Shakira en Argentina","shakira.jpg"),
(1,"La vela puerca Gira BSAS","laVela.jpg"),
(1,"Rolling Stones","RollingStones.jpg"),
(3,"Tomorrowland Rio 2019","tomorrowland.jpg"),
(1,"Las pastillas del Abuelo","lpda.jpg"),
(3,"Lollapalooza","lollapalooza.jpg"),
(5,"Equus","equus.jpg"),
(1,"Shakira Y Maluma","malumashakira.jpg"),
(1,"Ulises Bueno","ulises.jpg");

INSERT INTO EVENTPLACES (QUANTITY,NAME) VALUES
(65000,"Monumental"),
(52000,"Velez Sarfield"),
(9000,"Luna Park"),
(3200,"Gran Rex"),
(11000,"Polideportivo Islas Malvinas"),
(80000,"Estadio Maracan√°"),
(600,"Abbey Road");

INSERT INTO PLACETYPE (DESCRIPTION) VALUES
("General"),
("Platea"),
("Palco"),
("VIP"),
("Campo");

INSERT INTO USERS(email,password,nickName,isAdmin) VALUES
 ("admin@gmail.com","12345","admin","1"),
 ("client@gmail.com","12345","client","0");







